<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quizzer - Login / Register</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
<link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
<link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">
<meta name="theme-color" content="#00bcd4">

<style>
/* ====== Dark Theme Variables ====== */
:root {
    --bg-login: linear-gradient(135deg, #121212, #1e1e1e);
    --container-bg: #1e1e1e;
    --input-bg: #2a2a2a;
    --text-color: #f1f1f1;
    --placeholder-color: #bbb;
    --overlay-bg: linear-gradient(135deg, #00796b, #004d40);
    --overlay-text: #fff;
    --button-bg: linear-gradient(45deg, #00796b, #004d40);
}

/* ====== General Styles ====== */
* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Montserrat', sans-serif; }
body { display: flex; justify-content: center; align-items: center; height: 100vh; background: var(--bg-login); overflow: hidden; position: relative; color: var(--text-color); }

/* Floating background circles */
.circle { position: absolute; border-radius: 50%; opacity: 0.15; animation: float 10s infinite ease-in-out alternate; }
.circle1 { width: 200px; height: 200px; top: -50px; left: -50px; background: #fff; }
.circle2 { width: 300px; height: 300px; bottom: -100px; right: -80px; background: #000; animation-duration: 12s; }

/* Container */
.container {
    width: 750px; max-width: 95%; background: var(--container-bg); border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.25);
    display: flex; overflow: hidden; position: relative; z-index: 1; justify-content: center; align-items: center;
    transition: height 0.5s ease;
    padding: 20px 0;
}

/* Forms */
.form-container { width: 50%; padding: 20px 25px; transition: all 0.6s ease-in-out; display: flex; flex-direction: column; justify-content: center; }
.login-container { position: absolute; left: 0; top: 50%; transform: translateY(-50%); transition: all 0.6s ease-in-out; }
.register-container { position: absolute; left: 0; top: 50%; transform: translateY(-50%); opacity: 0; pointer-events: none; transition: all 0.6s ease-in-out; }
.container.show-register .register-container { opacity: 1; pointer-events: all; left: 50%; }
.container.show-register .login-container { opacity: 0; pointer-events: none; left: -50%; }

/* Titles */
.form-container h2 { text-align: center; color: #00bcd4; margin-bottom: 20px; font-size: 1.8rem; }

/* Inputs */
.input-field { margin-bottom: 10px; position: relative; }
.input-field input {
    width: 100%; padding: 10px 35px 10px 15px; border-radius: 25px; border: 2px solid #444; outline: none;
    transition: 0.3s; font-size: 0.95rem; background: var(--input-bg); color: var(--text-color);
}
.input-field input:focus { border-color: #00bcd4; box-shadow: 0 0 6px rgba(0,188,212,0.3); }
.input-field input::placeholder { color: var(--placeholder-color); }

/* Show/Hide password icon */
.input-field .toggle-password {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-80%); /* slightly more up than -50% */
    cursor: pointer;
    color: #bbb;
}


/* Error messages */
.input-field .error { color: #ff6b6b; font-size: 0.75rem; margin-top: 2px; min-height: 14px; }
.error-field { border-color: #ff6b6b !important; }

/* Buttons */
button { width: 100%; padding: 12px; border: none; border-radius: 25px;
    background: var(--button-bg); color: #fff; font-weight: bold; font-size: 1rem; cursor: pointer; margin-bottom: 10px; transition: 0.3s; }
button:hover { opacity: 0.9; transform: translateY(-2px); }

/* Toggle Links */
.toggle-text { text-align: center; font-size: 0.85rem; margin-top: 5px; }
.toggle-text a { color: #00bcd4; text-decoration: none; font-weight: bold; transition: 0.3s; }
.toggle-text a:hover { color: #00796b; }

/* Forgot Password */
.forgot-password { text-align: center; margin-bottom: 10px; font-size: 0.75rem; }
.forgot-password a { color: #00bcd4; text-decoration: none; font-weight: bold; }
.forgot-password a:hover { color: #00796b; }

/* Overlay */
.overlay-container {
    position: absolute; top: 0; left: 50%; width: 50%; height: 100%;
    background: var(--overlay-bg);
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    color: var(--overlay-text); text-align: center; padding: 40px 20px; transition: all 0.6s ease-in-out;
    border-radius: 0 20px 20px 0;
}
.container.show-register .overlay-container { left: 0; border-radius: 20px 0 0 20px; }
.overlay-container h2 { font-size: 2rem; margin-bottom: 15px; }
.overlay-container p { font-size: 0.95rem; margin-bottom: 20px; }
.overlay-container button { background: transparent; border: 2px solid #fff; padding: 10px 20px; border-radius: 25px; font-weight: bold; cursor: pointer; }
.overlay-container button:hover { background: #fff; color: #00796b; }

/* Flash messages */
.flash { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); padding: 12px 20px; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); z-index: 9999; color: var(--overlay-text); opacity: 1; font-weight: bold; text-align: center; min-width: 200px; }
.flash-success { background: #4CAF50; }
.flash-danger { background: #f44336; }
.flash-warning { background: #ff9800; }

/* Animations */
@keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-20px); } }

/* Responsive */
@media(max-width: 768px) {
    body { align-items: center; justify-content: center; min-height: 100vh; padding: 10px 0; overflow-y: auto; }
    .container { flex-direction: column; width: 100%; max-width: 360px; height: auto !important; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); border-radius: 15px; margin: 0 auto; display: flex; justify-content: center; }
    .overlay-container { display: none; }
    .login-container, .register-container { position: relative !important; width: 100%; transform: none !important; opacity: 1 !important; pointer-events: all !important; display: block; margin: 0 auto; }
    .register-container { display: none; }
    .circle1, .circle2 { width: 120px; height: 120px; top: -20px; left: -20px; bottom: auto; right: auto; opacity: 0.08; }
    .circle2 { bottom: -30px; right: -30px; animation-duration: 10s; }
    .input-field input { font-size: 0.9rem; padding: 8px 30px 8px 12px; }
    button { padding: 10px; font-size: 0.95rem; }
}
</style>
</head>
<body>

<!-- Floating circles -->
<div class="circle circle1"></div>
<div class="circle circle2"></div>

<!-- Flash messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="flash flash-{{ category }}">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

<div class="container" id="container">

    <!-- Login Form -->
    <div class="form-container login-container">
        <form id="loginForm" action="{{ url_for('login') }}" method="POST">
            <h2>Login</h2>
            <div class="input-field">
                <input type="text" name="identifier" placeholder="Email or Username">
                <div class="error"></div>
            </div>
            <div class="input-field">
    <input type="password" name="password" placeholder="Password" id="loginPassword">
    <i class="fas fa-eye toggle-password" toggle="#loginPassword"></i>
    <div class="error"></div>
</div>

<button type="submit">Login</button>

            <div class="forgot-password">
                <a href="{{ url_for('forgot_password') }}">Forgot Password?</a>
            </div>
            
            <div class="toggle-text">Don't have an account? <a href="#" id="showRegister">Sign Up</a></div>
        </form>
    </div>

    <!-- Register Form -->
    <div class="form-container register-container">
        <form id="registerForm" action="{{ url_for('register') }}" method="POST">
            <h2>Register</h2>
            <div class="input-field"><input type="text" name="first_name" placeholder="First Name"><div class="error"></div></div>
            <div class="input-field"><input type="text" name="last_name" placeholder="Last Name"><div class="error"></div></div>
            <div class="input-field"><input type="text" name="username" placeholder="Username"><div class="error"></div></div>
            <div class="input-field"><input type="email" name="email" placeholder="Email"><div class="error"></div></div>
            <div class="input-field">
                <input type="password" name="password" placeholder="Password" id="regPassword">
                <i class="fas fa-eye toggle-password" toggle="#regPassword"></i>
                <div class="error"></div>
            </div>
            <div class="input-field">
                <input type="password" name="confirm_password" placeholder="Confirm Password" id="regConfirmPassword">
                <i class="fas fa-eye toggle-password" toggle="#regConfirmPassword"></i>
                <div class="error"></div>
            </div>
            <button type="submit">Sign Up</button>
          
            <div class="toggle-text">Already have an account? <a href="#" id="showLogin">Login</a></div>
        </form>
    </div>

    <!-- Overlay -->
    <div class="overlay-container">
        <h2 id="overlayTitle">Welcome to Quizzer!</h2>
        <p id="overlayText">Engage in quizzes, challenge friends, and boost your knowledge!</p>
        <button id="overlayBtn">Get Started</button>
    </div>
</div>

<script>
// JS logic (unchanged)
const container = document.getElementById('container');
const loginForm = document.getElementById('loginForm');
const registerForm = document.getElementById('registerForm');
const overlayBtn = document.getElementById('overlayBtn');
const overlayTitle = document.getElementById('overlayTitle');
const overlayText = document.getElementById('overlayText');
const password = document.getElementById('regPassword');

function adjustContainerHeight() {
    const activeForm = container.classList.contains('show-register') ? registerForm : loginForm;
    const newHeight = activeForm.scrollHeight + 60;
    container.style.height = newHeight + 'px';
    if(container.classList.contains('show-register')){
        overlayTitle.textContent = "Already have an account?";
        overlayText.textContent = "Click below to login.";
        overlayBtn.textContent = "Login";
    } else {
        overlayTitle.textContent = "New here?";
        overlayText.textContent = "Click below to sign up.";
        overlayBtn.textContent = "Sign Up";
    }
}
window.addEventListener('load', adjustContainerHeight);

function showRegisterMobile() {
    if(window.innerWidth <= 768){
        document.querySelector('.login-container').style.display = 'none';
        document.querySelector('.register-container').style.display = 'block';
        window.scrollTo(0,0);
    } else {
        container.classList.add('show-register'); adjustContainerHeight();
    }
}
function showLoginMobile() {
    if(window.innerWidth <= 768){
        document.querySelector('.login-container').style.display = 'block';
        document.querySelector('.register-container').style.display = 'none';
        window.scrollTo(0,0);
    } else {
        container.classList.remove('show-register'); adjustContainerHeight();
    }
}
document.getElementById('showRegister').addEventListener('click', e => { e.preventDefault(); showRegisterMobile(); });
document.getElementById('showLogin').addEventListener('click', e => { e.preventDefault(); showLoginMobile(); });
overlayBtn.addEventListener('click', () => {
    if(window.innerWidth <= 768){
        const loginVisible = document.querySelector('.login-container').style.display !== 'none';
        if(loginVisible){ showRegisterMobile(); } else { showLoginMobile(); }
    } else {
        container.classList.toggle('show-register'); adjustContainerHeight();
    }
});

// Show/hide password
document.querySelectorAll('.toggle-password').forEach(icon => {
    icon.addEventListener('click', () => {
        const input = document.querySelector(icon.getAttribute('toggle'));
        if(input.type === 'password'){ input.type = 'text'; icon.classList.replace('fa-eye','fa-eye-slash'); } 
        else{ input.type = 'password'; icon.classList.replace('fa-eye-slash','fa-eye'); }
    });
});

// ----- install on mobile --- //
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('{{ url_for("static", filename="sw.js") }}')
    .then(reg => console.log('✅ Service Worker registered:', reg))
    .catch(err => console.log('❌ Service Worker registration failed:', err));
}

</script>
</body>
</html>



